window.__require=function t(e,o,c){function s(n,a){if(!o[n]){if(!e[n]){var r=n.split("/");if(r=r[r.length-1],!e[r]){var h="function"==typeof __require&&__require;if(!a&&h)return h(r,!0);if(i)return i(r,!0);throw new Error("Cannot find module '"+n+"'")}}var u=o[n]={exports:{}};e[n][0].call(u.exports,function(t){return s(e[n][1][t]||t)},u,u.exports,t,e,o,c)}return o[n].exports}for(var i="function"==typeof __require&&__require,n=0;n<c.length;n++)s(c[n]);return s}({block:[function(t,e,o){"use strict";cc._RF.push(e,"b6c808XNx1MoZuqsTry0QDM","block");var c=function(t){return t&&t.__esModule?t:{default:t}}(t("colors"));cc.Class({extends:cc.Component,properties:{numLabel:cc.Label,isCompound:!1},start:function(){},setNumber:function(t){0==t&&(this.numLabel.node.active=!1),this.numLabel.string=t,t in c.default&&(this.node.color=c.default[t])}}),cc._RF.pop()},{colors:"colors"}],colors:[function(t,e,o){"use strict";cc._RF.push(e,"979a3n+OAhBRI0bP0PyxLGb","colors");var c=[];c[0]=cc.color(30,139,112,255),c[2]=cc.color(192,180,165,255),c[4]=cc.color(242,203,53,255),c[8]=cc.color(255,137,31,255),c[16]=cc.color(255,10,21,255),c[32]=cc.color(125,203,62,255),c[64]=cc.color(196,123,251,255),c[128]=cc.color(255,1,157,255),c[256]=cc.color(18,181,89,255),c[512]=cc.color(133,0,245,255),c[1024]=cc.color(1,142,230,255),c[2048]=cc.color(230,1,98,255),e.exports=c,cc._RF.pop()},{}],game:[function(t,e,o){"use strict";cc._RF.push(e,"ae6d4O5dXFHs7EouAgCg973","game");var c=[2,4],s="hammer_watch_ads_get_hammer";cc.Class({extends:cc.Component,properties:{scoreLabel:cc.Label,score:0,blockPrefab:cc.Prefab,gap:20,bg:cc.Node,gameOverSence:cc.Node,retryLabel:cc.RichText,gameOverBg:cc.Node,checkSuccess:!0,gameSuccessSence:cc.Node,gameSuccessRetryButton:cc.Button,gameSuccessContinueButton:cc.Button,highestScoreLabel:cc.Label,isAniming:!1,isDeleting:!1,titleBg:cc.Graphics,coreBg:cc.Node,propBg:cc.Graphics,pauseButton:cc.Sprite,gamePauseState:!1,gamePauseBg:cc.Node,gamePauseButtonBg:cc.Node,pauseResumeButton:cc.Button,pauseNewGameButton:cc.Button,successBg:cc.Node,hammerButton:cc.Sprite,generateButton:cc.Sprite,hammerSenseBg:cc.Node,hamBg:cc.Node,useHammerButton:cc.Button,hammerTotalCount:cc.Label,propGetHammer:cc.Button,successDoubleHammer:cc.Button,closeHammer:cc.Sprite,revive:cc.Button},requestAds:function(t){var e=this.getParentUrl();window.top.postMessage("invoke@@@GameModel.Game.requestAds#"+t,e)},getParentUrl:function(){var t=null;if(parent!==window)try{t=parent.location.href}catch(e){t=document.referrer}return t},onKeyDown:function(t){switch(t.keyCode){case cc.macro.KEY.up:this.move(0);break;case cc.macro.KEY.down:this.move(1);break;case cc.macro.KEY.left:this.move(2);break;case cc.macro.KEY.right:this.move(3)}},start:function(){cc.debug.setDisplayStats(!1);var t=this;this.drawGameOverBg(),this.drawGamePauseBg(),this.drawBgBlocks(),this.drawTitleBg(),this.drawPropBg(),this.drawSuccessBg(),this.drawHammerBg(),this.init(),this.addEventHandler(),window.addEventListener("message",function(e){var o=e.data.status,c=e.data.extra;if("new_game"==c)t.init();else if(c==s){if("closed"==o||"completed"==o){var i=cc.sys.localStorage.getItem(t.getToday()+s);i<3&&(t.addOneHammer(),cc.sys.localStorage.setItem(t.getToday()+s,i-0+1)),t.updateHammerCount()}}else"success_watch_ads_get_double_hammer"==c?"closed"!=o&&"completed"!=o||(t.addOneHammer(),t.updateHammerCount()):"fail_revive"==c?"closed"!=o&&"completed"!=o||this.failRevive():t.init()},!1)},failRevive:function(){for(var t=0;t<4;t++)null!=this.blocks[3][t]&&(this.blocks[3][t].destroy(),this.data[3][t]=0)},addOneHammer:function(){var t=cc.sys.localStorage.getItem("hammer_count");cc.sys.localStorage.setItem("hammer_count",t-0+1)},reduceOneHammer:function(){var t=cc.sys.localStorage.getItem("hammer_count");t>0&&cc.sys.localStorage.setItem("hammer_count",t-0-1)},updateHammerCount:function(){var t=cc.sys.localStorage.getItem("hammer_count");null==t&&(t=0),this.hammerTotalCount.string=t+" X",this.useHammerButton.enabled=t>0;var e=cc.sys.localStorage.getItem(this.getToday()+s);this.propGetHammer.node.getChildByName("Background").getChildByName("Label").getComponent(cc.Label).string=e>=3?"no times":"Watch ads"},getToday:function(){var t=new Date;return t.getFullYear()+(t.getMonth()+1<10?"0"+t.getMonth()+1:t.getMonth()+1)+(t.getDate()<10?"0"+t.getDate():t.getDate())},drawHammerBg:function(){var t=this.hamBg.getComponent(cc.Graphics),e=cc.Color.BLACK;e.fromHEX("#B1ACAC"),e.a=255,t.fillColor=e,t.roundRect(0,0,this.hamBg.getContentSize().width,this.hamBg.getContentSize().height,20),t.fill()},drawSuccessBg:function(){var t=this.successBg.getComponent(cc.Graphics),e=cc.Color.BLACK;e.fromHEX("#B1ACAC"),e.a=255,t.fillColor=e,t.roundRect(0,0,this.successBg.getContentSize().width,this.successBg.getContentSize().height,20),t.fill()},drawGameOverBg:function(){var t=this.gameOverBg.getComponent(cc.Graphics),e=cc.Color.BLACK;e.fromHEX("#B1ACAC"),e.a=255,t.fillColor=e,t.roundRect(0,0,this.gameOverBg.getContentSize().width,this.gameOverBg.getContentSize().height,20),t.fill()},drawGamePauseBg:function(){var t=this.gamePauseButtonBg.getComponent(cc.Graphics),e=cc.Color.BLACK;e.fromHEX("#8E8686"),e.a=255,t.fillColor=e,t.roundRect(0,0,this.gamePauseButtonBg.getContentSize().width,this.gamePauseButtonBg.getContentSize().height,20),t.fill()},drawTitleBg:function(){var t=this.titleBg.getComponent(cc.Graphics),e=cc.Color.BLACK;e.fromHEX("#C2BDBD"),e.a=255,t.fillColor=e,t.roundRect(0,0,this.titleBg.node.getContentSize().width,this.titleBg.node.getContentSize().height,20),t.fill()},drawPropBg:function(){var t=this.propBg.getComponent(cc.Graphics),e=cc.Color.BLACK;e.fromHEX("#C2BDBD"),e.a=255,t.fillColor=e,t.roundRect(0,0,this.propBg.node.getContentSize().width,this.propBg.node.getContentSize().height,60),t.fill()},addEventHandler:function(){var t=this;this.coreBg.on("touchstart",function(e){t.startPoint=e.getLocation()}),this.coreBg.on("touchend",function(e){t.isDeleting?t.findBlockTouched(e):t.touchEnd(e)}),this.coreBg.on("touchcancel",function(e){t.touchEnd(e)}),cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN,function(e){t.isAniming||t.onKeyDown(e)},this),this.retryLabel.node.on("touchstart",function(e){t.init()}),this.gameSuccessRetryButton.node.on("click",function(e){t.init()}),this.gameSuccessContinueButton.node.on("click",function(e){t.gameSuccessSence.active=!1,t.checkSuccess=!1}),this.pauseButton.node.on("touchstart",function(e){t.setGamePause()}),this.pauseResumeButton.node.on("click",function(e){t.setGameResume()}),this.pauseNewGameButton.node.on("click",function(e){t.gamePauseBg.active=!1,t.init()}),this.hammerButton.node.on("touchstart",function(e){t.showHammerSense()}),this.generateButton.node.on("touchstart",function(t){}),this.useHammerButton.node.on("click",function(e){cc.sys.localStorage.getItem("hammer_count")>0&&(t.isDeleting=!0,t.dismissHammerSense())}),this.gamePauseBg.on("touchstart",function(t){}),this.gamePauseBg.on("touchend",function(t){}),this.propGetHammer.node.on("click",function(e){cc.sys.localStorage.getItem(t.getToday()+s)>=3?t.updateHammerCount():t.requestAds(s)}),this.successDoubleHammer.node.on("click",function(e){t.requestAds("success_watch_ads_get_double_hammer")}),this.closeHammer.node.on("touchstart",function(e){t.dismissHammerSense()}),this.revive.node.on("click",function(e){t.requestAds("fail_revive")})},showHammerSense:function(){this.hammerSenseBg.active=!0,this.updateHammerCount()},dismissHammerSense:function(){this.hammerSenseBg.active=!1},setGamePause:function(){this.gamePauseState=!0,this.gamePauseBg.active=!0,cc.director.pause()},setGameResume:function(){this.gamePauseState=!1,this.gamePauseBg.active=!1,cc.director.resume()},touchEnd:function(t){this.endPoint=t.getLocation();var e=this.endPoint.sub(this.startPoint);e.mag()>50&&(Math.abs(e.x)>Math.abs(e.y)?e.x>0?this.move(3):this.move(2):e.y>0?this.move(0):this.move(1))},afterMove:function(t){t&&(this.updateScore(this.score+10),this.addBlock()),this.updateHighestScore(),this.checkIsSuccess()&&this.gameSuccess(),this.checkFail()&&this.gameOver()},checkIsSuccess:function(){for(var t=0;t<4;t++)for(var e=0;e<4;e++){var o=this.data[t][e];if(this.checkSuccess&&o>=2048)return this.checkSuccess=!1,!0}return!1},checkFail:function(){for(var t=0;t<4;t++)for(var e=0;e<4;e++){var o=this.data[t][e];if(0==o)return!1;if(e>0&&this.data[t][e-1]==o)return!1;if(e<3&&this.data[t][e+1]==o)return!1;if(t>0&&this.data[t-1][e]==o)return!1;if(t<3&&this.data[t+1][e]==o)return!1}return!0},gameSuccess:function(){this.gameSuccessSence.active=!0,this.addOneHammer(),this.updateHammerCount()},gameOver:function(){this.gameOverSence.active=!0},doMove:function(t,e,o){var c=this;this.isAniming=!0;var s=cc.moveTo(.05,e),i=cc.callFunc(function(){c.isAniming=!1,o&&o()});t.runAction(cc.sequence(s,i))},move:function(t){var e=this;this.isDeleting=!1;var o=!1,c=function c(s,i,n){var a=void 0,r=void 0,h=void 0;if(0==t?(a=3,s+1<4&&(r=e.data[s+1][i],h=e.poisitions[s+1][i])):1==t?(a=0,s-1>=0&&(r=e.data[s-1][i],h=e.poisitions[s-1][i])):2==t?(a=0,i-1>=0&&(r=e.data[s][i-1],h=e.poisitions[s][i-1])):(a=3,i+1<4&&(r=e.data[s][i+1],h=e.poisitions[s][i+1])),(2!=t&&3!=t||i!=a)&&(0!=t&&1!=t||s!=a)&&0!=e.data[s][i])if(0==r){var u=e.blocks[s][i];0==t?(e.blocks[s+1][i]=u,e.data[s+1][i]=e.data[s][i],e.data[s][i]=0,e.blocks[s][i]=null,e.doMove(u,h,function(){c(s+1,i,n)})):1==t?(e.blocks[s-1][i]=u,e.data[s-1][i]=e.data[s][i],e.data[s][i]=0,e.blocks[s][i]=null,e.doMove(u,h,function(){c(s-1,i,n)})):2==t?(e.blocks[s][i-1]=u,e.data[s][i-1]=e.data[s][i],e.data[s][i]=0,e.blocks[s][i]=null,e.doMove(u,h,function(){c(s,i-1,n)})):(e.blocks[s][i+1]=u,e.data[s][i+1]=e.data[s][i],e.data[s][i]=0,e.blocks[s][i]=null,e.doMove(u,h,function(){c(s,i+1,n)})),o=!0}else{if(r!=e.data[s][i])return void(n&&n());var l=e.blocks[s][i];if(0==t){if(e.blocks[s+1][i].isCompound)return void(n&&n());e.data[s+1][i]=2*r,e.data[s][i]=0,e.blocks[s][i]=null,e.blocks[s+1][i].getComponent("block").setNumber(e.data[s+1][i]),e.blocks[s+1][i].isCompound=!0,e.doMove(l,h,function(){l.destroy(),n&&n()})}else if(1==t){if(e.blocks[s-1][i].isCompound)return void(n&&n());e.data[s-1][i]=2*r,e.data[s][i]=0,e.blocks[s][i]=null,e.blocks[s-1][i].getComponent("block").setNumber(e.data[s-1][i]),e.blocks[s-1][i].isCompound=!0,e.doMove(l,h,function(){l.destroy(),n&&n()})}else if(2==t){if(e.blocks[s][i-1].isCompound)return void(n&&n());e.data[s][i-1]=2*r,e.data[s][i]=0,e.blocks[s][i]=null,e.blocks[s][i-1].getComponent("block").setNumber(e.data[s][i-1]),e.blocks[s][i-1].isCompound=!0,e.doMove(l,h,function(){l.destroy(),n&&n()})}else{if(e.blocks[s][i+1].isCompound)return void(n&&n());e.data[s][i+1]=2*r,e.data[s][i]=0,e.blocks[s][i]=null,e.blocks[s][i+1].getComponent("block").setNumber(e.data[s][i+1]),e.blocks[s][i+1].isCompound=!0,e.doMove(l,h,function(){l.destroy(),n&&n()})}o=!0}else n&&n()},s=[];if(0==t)for(var i=3;i>=0;i--)for(var n=0;n<4;n++)null!=this.blocks[i][n]&&(this.blocks[i][n].isCompound=!1),0!=this.data[i][n]&&s.push({x:i,y:n});else if(1==t)for(var a=0;a<4;a++)for(var r=0;r<4;r++)null!=this.blocks[a][r]&&(this.blocks[a][r].isCompound=!1),0!=this.data[a][r]&&s.push({x:a,y:r});else if(2==t)for(var h=0;h<4;h++)for(var u=0;u<4;u++)null!=this.blocks[h][u]&&(this.blocks[h][u].isCompound=!1),0!=this.data[h][u]&&s.push({x:h,y:u});else for(var l=0;l<4;l++)for(var d=3;d>=0;d--)null!=this.blocks[l][d]&&(this.blocks[l][d].isCompound=!1),0!=this.data[l][d]&&s.push({x:l,y:d});for(var m=0,g=0;g<s.length;g++)c(s[g].x,s[g].y,function(){++m==s.length&&e.afterMove(o)})},init:function(){if(this.updateHighestScore(),this.gameOverSence.active=!1,this.gameSuccessSence.active=!1,this.checkSuccess=!0,this.updateScore(0),this.blocks)for(var t=0;t<this.blocks.length;t++)for(var e=0;e<this.blocks[t].length;e++)null!=this.blocks[t][e]&&this.blocks[t][e].destroy();this.data=[],this.blocks=[];for(var o=0;o<4;o++)this.blocks.push([null,null,null,null]),this.data.push([0,0,0,0]);this.addBlock(),this.addBlock(),this.addBlock()},findBlockTouched:function(t){for(var e=this.coreBg.convertToNodeSpace(cc.v2(t.getLocationX(),t.getLocationY())),o=0;o<this.poisitions.length;o++)for(var c=0;c<this.poisitions[o].length;c++){var s=this.poisitions[o][c],i=s.x-this.blockSize/2,n=s.x+this.blockSize/2,a=s.y-this.blockSize/2,r=s.y+this.blockSize/2;e.x>=i&&e.x<=n&&e.y>=a&&e.y<=r&&(this.deleteBlock(o,c),this.isDeleting=!1)}},deleteBlock:function(t,e){if(null!=this.blocks[t][e]){if(this.getEmptyLocations().length>=this.blocks.length*this.blocks[0].length-1)return;var o=cc.blink(1,2),c=cc.fadeOut(.5),s=cc.sequence(o,c),i=cc.callFunc(function(){});this.blocks[t][e].runAction(cc.sequence(s,i)),this.blocks[t][e]=null,this.data[t][e]=0,this.reduceOneHammer()}},updateHighestScore:function(){var t=cc.sys.localStorage.getItem("highest_score");null==t?null!=this.score?(cc.sys.localStorage.setItem("highest_score",this.score),this.highestScoreLabel.string=this.score):this.highestScoreLabel.string="0":null!=this.score&&t<this.score?(cc.sys.localStorage.setItem("highest_score",this.score),this.highestScoreLabel.string=this.score):this.highestScoreLabel.string=t},addBlock:function(){var t=this.getEmptyLocations();if(0==t.length)return!1;var e=t[Math.floor(Math.random()*t.length)],o=e.x,s=e.y,i=this.poisitions[o][s],n=cc.instantiate(this.blockPrefab);n.width=this.blockSize,n.height=this.blockSize,this.coreBg.addChild(n),n.setPosition(i);var a=c[Math.floor(Math.random()*c.length)];return n.getComponent("block").setNumber(a),this.blocks[o][s]=n,this.data[o][s]=a,!0},getEmptyLocations:function(){for(var t=[],e=0;e<this.blocks.length;e++)for(var o=0;o<this.blocks[e].length;o++)null==this.blocks[e][o]&&t.push({x:e,y:o});return t},updateScore:function(t){this.score=t,this.scoreLabel.string=t},onDestroy:function(){var t=this;cc.systemEvent.off(cc.SystemEvent.EventType.KEY_DOWN,function(e){t.onKeyDown()},this)},drawBgBlocks:function(){this.blockSize=(this.coreBg.getContentSize().width-5*this.gap)/4;var t=this.gap+this.blockSize/2,e=this.gap+this.blockSize/2;this.poisitions=[];for(var o=0;o<4;++o){this.poisitions.push([0,0,0,0]);for(var c=0;c<4;++c){var s=cc.instantiate(this.blockPrefab);s.width=this.blockSize,s.height=this.blockSize,this.coreBg.addChild(s),s.setPosition(cc.v2(t,e)),this.poisitions[o][c]=cc.v2(t,e),t+=this.gap+this.blockSize,s.getComponent("block").setNumber(0)}e+=this.gap+this.blockSize,t=this.gap+this.blockSize/2}}}),cc._RF.pop()},{}]},{},["block","colors","game"]);